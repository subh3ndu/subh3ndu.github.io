<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>TmpD52G6ymNFm</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <style type="text/css">:root {--c-caption: grey;--c-blue: #26bfe3;--c-green: #02e180;--c-orange: #f2971a;--c-pink: #e3266f;--c-bg: #fff;--c-bg-alt: #f5f5f5;--c-text-header: #fff;--c-text-body: #95989a;--padding: 20px;--padding-inv: calc(-1 * var(--padding));--fonts: "Open Sans", -apple-system, system-ui, "Segoe UI", "Roboto","Helvetica Neue", Arial, sans-serif;--font-size: 1.1rem;}html {font-size: 100%;}body {color: #444;font-family: var(--fonts);font-size: var(--font-size);line-height: 1.7;padding: 1em;margin: auto;max-width: 800px;background: #fefefe;}a {color: #0645ad;text-decoration: none;}a:visited {color: #0b0080;}a:hover {color: #06e;}a:active {color: #faa700;}a:focus {outline: thin dotted;}a::selection {background: rgba(255, 255, 0, 0.3);color: #0645ad;}*::selection {background: rgba(255, 255, 0, 0.3);color: #000;}p {margin: 1em 0;}.caption {text-align: center;color: var(--c-caption);font-style: italic;}.note,.tips,.warning {display: block;width: calc(100% - var(--padding) * 2);padding: 0 var(--padding);padding-bottom: var(--padding);background-color: var(--c-bg-alt);}.note:before,.tips:before,.warning:before {display: block;margin: 0 var(--padding-inv) 10px var(--padding-inv);padding-left: var(--padding);font-style: bold;color: white;}.note:before {content: "Note";background-color: var(--c-blue);}.tips:before {content: "Tips";background-color: var(--c-pink);}.warning:before {content: "Warning";background-color: var(--c-orange);}img {max-width: 100%;}h1,h2,h3,h4,h5,h6 {color: #111;line-height: 125%;margin-top: 2em;font-weight: normal;}h4,h5,h6 {font-weight: bold;}h1 {font-size: 2.5em;}h2 {font-size: 2em;}h3 {font-size: 1.5em;}h4 {font-size: 1.2em;}blockquote {color: #666666;margin: 0;padding-left: 3em;border-left: 0.5em #eee solid;}hr {display: block;height: 2px;border: 0;border-top: 1px solid #aaa;border-bottom: 1px solid #eee;margin: 1em 0;padding: 0;}pre,code,kbd,samp {color: #0084b8;font-family: monospace, monospace;}pre {background-color: #f9f9f9;padding: 1em;font-size: 14px;white-space: pre-wrap;word-wrap: break-word;}code {white-space: pre-wrap;}b,strong {font-weight: bold;}dfn {font-style: italic;color: var(--c-blue);}ins {background: #ff9;color: #000;text-decoration: none;}ul,ol {margin: 1em 0;padding: 0 0 0 2em;}li p:last-child {margin-bottom: 0;}ul ul,ol ol {margin: 0.3em 0;}dl {margin-bottom: 1em;}dt {font-weight: bold;margin-bottom: 0.8em;}dd {margin: 0 0 0.8em 2em;}dd:last-child {margin-bottom: 0;}img {border: 0;-ms-interpolation-mode: bicubic;vertical-align: middle;}figure {display: block;text-align: center;margin: 1em 0;}figure img {border: none;margin: 0 auto;}figcaption {font-size: 0.8em;font-style: italic;margin: 0 0 0.8em;}.author {font-size: 1.2em;text-align: center;}tag {min-width: 3.2em;text-align: center;border-radius: 8px;padding: 0 4px;margin-bottom: 0;margin-top: 4px;margin-right: 0.2em;display: inline-block;color: white;}tag.update {background: var(--c-blue);}tag.new {background: var(--c-green);}tag.update:after {content: "update";}tag.new:after {content: "new";}button {background-color: var(--c-blue);color: white;border: none;cursor: pointer;line-height: 2rem;font-size: 1.2rem;margin: 0.75rem 0;overflow: visible;padding: 0.75rem 1.5rem;border-radius: 1rem;transition: background-color $transition-duration;white-space: nowrap;}</style>
</head>
<body>
<h1 id="the-state-pattern">The State pattern</h1>
<p><em>Split an object’s finite number of states or behaviors into individual state objects and only allow one of them to control their host at a time.</em></p>
<p>You’ve probably heard of this pattern called finite state machines, often represented as a graph.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>It’s a natural way to mentally break down a game entity or a program into high-level states. It’s widely used in games.</p>
<p>In this guide, we’ll see how to implement it in Godot, with GDScript code and nodes. We will use the convenient <code>owner</code> property of nodes to keep our state code simple.</p>
<p>Before that, let’s start by looking at the problem this pattern tries to solve and an intermediate solution for simple cases.</p>
<p><em>The code examples you’ll see in this guide are simple to keep it short and clear. You can find a complete companion demo in our <a href="https://github.com/GDQuest/godot-design-patterns">Godot design patterns</a> repository.</em></p>
<p><em>But please note the pattern is mostly worth it when you start to have more complex code. For a concrete example, see our <a href="https://github.com/GDQuest/godot-3d-mannequin">Open 3D Mannequin</a>.</em></p>
<h2 id="the-problem">The problem</h2>
<p>Imagine you have a character that needs to stand idle, run, and jump.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>In its update loop, you write all the conditions for it to do all these actions, and it goes just fine. <code>KinematicBody2D</code> in Godot makes it especially easy to detect if the character is on the floor or not.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Character that moves and jumps.</span>
class_name Player
<span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">KinematicBody2D</span>

<span style="color:#66d9ef">var</span> speed :<span style="color:#f92672">=</span> <span style="color:#ae81ff">500.0</span>
<span style="color:#66d9ef">var</span> jump_impulse :<span style="color:#f92672">=</span> <span style="color:#ae81ff">1200.0</span>
<span style="color:#66d9ef">var</span> base_gravity :<span style="color:#f92672">=</span> <span style="color:#ae81ff">4000.0</span>

<span style="color:#66d9ef">var</span> _velocity :<span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span><span style="color:#f92672">.</span>ZERO


<span style="color:#66d9ef">func</span> _physics_process(delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e"># Starting with input.</span>
    <span style="color:#66d9ef">var</span> input_direction_x: <span style="color:#a6e22e">float</span> <span style="color:#f92672">=</span> (
        <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;move_right&quot;</span>)
        <span style="color:#f92672">-</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;move_left&quot;</span>)
    )
    <span style="color:#66d9ef">var</span> is_jumping :<span style="color:#f92672">=</span> is_on_floor() <span style="color:#f92672">and</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;move_up&quot;</span>)

    <span style="color:#75715e"># Calculating horizontal velocity.</span>
    _velocity<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> input_direction_x <span style="color:#f92672">*</span> speed
    <span style="color:#75715e"># Calculating vertical velocity.</span>
    _velocity<span style="color:#f92672">.</span>y <span style="color:#f92672">+=</span> base_gravity <span style="color:#f92672">*</span> delta
    <span style="color:#66d9ef">if</span> is_jumping:
        _velocity<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>jump_impulse
    <span style="color:#75715e"># Moving the character.</span>
    _velocity <span style="color:#f92672">=</span> move_and_slide(_velocity)
</pre>
<p>That’s simple enough. Now, we want the character to glide, but only if it’s in the air. When it’s gliding, the character falls slower and they can’t turn around instantly. Also, when gliding, the player can hop, canceling the glide, and jumping lower than a regular jump.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Character that moves, jumps, and glides.</span>
class_name Player
<span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">KinematicBody2D</span>

<span style="color:#66d9ef">var</span> speed :<span style="color:#f92672">=</span> <span style="color:#ae81ff">500.0</span>
<span style="color:#66d9ef">var</span> jump_impulse :<span style="color:#f92672">=</span> <span style="color:#ae81ff">1200.0</span>
<span style="color:#66d9ef">var</span> base_gravity :<span style="color:#f92672">=</span> <span style="color:#ae81ff">4000.0</span>

<span style="color:#75715e"># Here are the new variables for gliding.</span>
<span style="color:#66d9ef">var</span> glide_max_speed :<span style="color:#f92672">=</span> <span style="color:#ae81ff">1000.0</span>
<span style="color:#66d9ef">var</span> glide_acceleration :<span style="color:#f92672">=</span> <span style="color:#ae81ff">1000.0</span>
<span style="color:#66d9ef">var</span> glide_gravity :<span style="color:#f92672">=</span> <span style="color:#ae81ff">1000.0</span>
<span style="color:#66d9ef">var</span> glide_jump_impulse :<span style="color:#f92672">=</span> <span style="color:#ae81ff">500.0</span>

<span style="color:#66d9ef">var</span> _velocity :<span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span><span style="color:#f92672">.</span>ZERO
<span style="color:#75715e"># There&#39;s also a new boolean value to keep track of the gliding state.</span>
<span style="color:#66d9ef">var</span> _is_gliding :<span style="color:#f92672">=</span> false


<span style="color:#66d9ef">func</span> _physics_process(delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e"># Starting with input.</span>
    <span style="color:#66d9ef">var</span> input_direction_x: <span style="color:#a6e22e">float</span> <span style="color:#f92672">=</span> (
        <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;move_right&quot;</span>)
        <span style="color:#f92672">-</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;move_left&quot;</span>)
    )
    <span style="color:#66d9ef">var</span> is_jumping :<span style="color:#f92672">=</span> is_on_floor() <span style="color:#f92672">and</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;move_up&quot;</span>)

    <span style="color:#75715e"># Initiating gliding, only when the character is in the air.</span>
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;glide&quot;</span>) <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> is_on_floor():
        _is_gliding <span style="color:#f92672">=</span> true

    <span style="color:#75715e"># canceling gliding</span>
    <span style="color:#66d9ef">if</span> _is_gliding <span style="color:#f92672">and</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;move_up&quot;</span>):
        _is_gliding <span style="color:#f92672">=</span> false

    <span style="color:#75715e"># Calculating horizontal velocity.</span>
    <span style="color:#66d9ef">if</span> _is_gliding:
        _velocity<span style="color:#f92672">.</span>x <span style="color:#f92672">+=</span> input_direction_x <span style="color:#f92672">*</span> glide_acceleration
        _velocity<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> min(_velocity<span style="color:#f92672">.</span>x, glide_max_speed)
    <span style="color:#66d9ef">else</span>:
        _velocity<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> input_direction_x <span style="color:#f92672">*</span> speed

    <span style="color:#75715e"># Calculating vertical velocity.</span>
    <span style="color:#66d9ef">var</span> gravity :<span style="color:#f92672">=</span> glide_gravity <span style="color:#66d9ef">if</span> _is_gliding <span style="color:#66d9ef">else</span> base_gravity
    _velocity<span style="color:#f92672">.</span>y <span style="color:#f92672">+=</span> gravity <span style="color:#f92672">*</span> delta
    <span style="color:#66d9ef">if</span> is_jumping:
        <span style="color:#66d9ef">var</span> impulse <span style="color:#f92672">=</span> jump_impulse <span style="color:#66d9ef">if</span> is_on_floor() <span style="color:#66d9ef">else</span> glide_jump_impulse
        _velocity<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>impulse

    <span style="color:#75715e"># Moving the character.</span>
    _velocity <span style="color:#f92672">=</span> move_and_slide(_velocity)

    <span style="color:#75715e"># If we&#39;re gliding and we collide with something, we turn gliding off and the character falls.</span>
    <span style="color:#66d9ef">if</span> _is_gliding <span style="color:#f92672">and</span> get_slide_count() <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
        _is_gliding <span style="color:#f92672">=</span> false
</pre>
<p>We have to add conditional checks in multiple places to distinguish glide movement from other movements.</p>
<p>The code doubled in size, even though our character movement is still dead simple. We had to introduce a boolean variable to check if the character is gliding. If it weren’t for <code>KinematicBody2D</code>’s convenient <code>is_on_floor()</code> method, we’d need another one for that.</p>
<p>Did you notice the error up there?</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">var</span> is_jumping :<span style="color:#f92672">=</span> is_on_floor() <span style="color:#f92672">and</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;move_up&quot;</span>)
</pre>
<p>We want to allow jumping during glide, but I forgot to update the <code>is_jumping</code> variable, and so it doesn’t work. When you put all your movements and state in one place, these changes are easy to miss. More issues in the code above make it brittle and difficult to change, even though it is still relatively small. But we don’t have sounds, animations, and movement is still basic. In a real game project, the code gets messy fast.</p>
<p>Now, imagine the project moves forward, and you realize that you also want the character to dash, climb on walls, grab ledges, climb ladders, shoot, do combos with a sword, and a bazillion other things. You need more variables to check in which states the character is, and conditional combinations explode.</p>
<p>If you try to shove it all in the same class, using only boolean variables to keep track of your character’s current state, it soon becomes unmanageable. In particular, every variable you add in one place increases the chance of bugs creeping up on you. That’s because there are just too many conditions to check to know what the character can or cannot do right now and properly chain the behaviors.</p>
<p>You could and should split your code into multiple functions, but that won’t be enough to manage the overwhelming possible interactions between all the character’s states.</p>
<h2 id="state-variable">State variable</h2>
<p>A simple solution to this problem is to define a variable named <code>state</code> that stores a text string or a member from an enumeration and helps you keep track of which state the character is in.</p>
<p>You can then use it in conditions or in a match block to know what the character can or cannot do.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Character that moves and jumps.</span>
class_name Player
<span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">KinematicBody2D</span>

<span style="color:#75715e"># An enum allows us to keep track of valid states.</span>
<span style="color:#66d9ef">enum</span> States {ON_GROUND, IN_AIR, GLIDING}

<span style="color:#75715e">#...</span>

<span style="color:#75715e"># With a variable that keeps track of the current state, we don&#39;t need to add more booleans.</span>
<span style="color:#66d9ef">var</span> _state : <span style="color:#a6e22e">int</span> <span style="color:#f92672">=</span> States<span style="color:#f92672">.</span>ON_GROUND


<span style="color:#66d9ef">func</span> _physics_process(delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e">#...</span>
    <span style="color:#75715e"># Instead of using different functions and variables, we can now use a single variable </span>
    <span style="color:#75715e"># to manage the current state.</span>
    <span style="color:#66d9ef">var</span> is_jumping: <span style="color:#a6e22e">bool</span> <span style="color:#f92672">=</span> _state <span style="color:#f92672">==</span> States<span style="color:#f92672">.</span>ON_GROUND <span style="color:#f92672">and</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;move_up&quot;</span>)

    <span style="color:#75715e"># To change state, we change the value of the `_state` variable</span>
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;glide&quot;</span>) <span style="color:#f92672">and</span> _state <span style="color:#f92672">==</span> States<span style="color:#f92672">.</span>IN_AIR:
        _state <span style="color:#f92672">=</span> States<span style="color:#f92672">.</span>GLIDING

    <span style="color:#75715e"># Canceling gliding.</span>
    <span style="color:#66d9ef">if</span> _state <span style="color:#f92672">==</span> States<span style="color:#f92672">.</span>GLIDING <span style="color:#f92672">and</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;move_up&quot;</span>):
        _state <span style="color:#f92672">=</span> States<span style="color:#f92672">.</span>IN_AIR

    <span style="color:#75715e"># Calculating horizontal velocity.</span>
    <span style="color:#66d9ef">if</span> _state <span style="color:#f92672">==</span> States<span style="color:#f92672">.</span>GLIDING:
        _velocity<span style="color:#f92672">.</span>x <span style="color:#f92672">+=</span> input_direction_x <span style="color:#f92672">*</span> glide_acceleration <span style="color:#f92672">*</span> delta
        _velocity<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> min(_velocity<span style="color:#f92672">.</span>x, glide_max_speed)
    <span style="color:#66d9ef">else</span>:
        _velocity<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> input_direction_x <span style="color:#f92672">*</span> speed

    <span style="color:#75715e"># Calculating vertical velocity.</span>
    <span style="color:#66d9ef">var</span> gravity :<span style="color:#f92672">=</span> glide_gravity <span style="color:#66d9ef">if</span> _state <span style="color:#f92672">==</span> States<span style="color:#f92672">.</span>GLIDING <span style="color:#66d9ef">else</span> base_gravity
    _velocity<span style="color:#f92672">.</span>y <span style="color:#f92672">+=</span> gravity <span style="color:#f92672">*</span> delta
    <span style="color:#66d9ef">if</span> is_jumping:
        <span style="color:#66d9ef">var</span> impulse <span style="color:#f92672">=</span> glide_jump_impulse <span style="color:#66d9ef">if</span> _state <span style="color:#f92672">==</span> States<span style="color:#f92672">.</span>GLIDING <span style="color:#66d9ef">else</span> jump_impulse
        _velocity<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>impulse
        _state <span style="color:#f92672">=</span> States<span style="color:#f92672">.</span>IN_AIR

    <span style="color:#75715e"># Moving the character.</span>
    _velocity <span style="color:#f92672">=</span> move_and_slide(_velocity, <span style="color:#a6e22e">Vector2</span><span style="color:#f92672">.</span>UP)

    <span style="color:#75715e"># If we&#39;re gliding and we collide with something, we turn gliding off and the character falls.</span>
    <span style="color:#66d9ef">if</span> _state <span style="color:#f92672">==</span> States<span style="color:#f92672">.</span>GLIDING <span style="color:#f92672">and</span> get_slide_count() <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
        _state <span style="color:#f92672">=</span> States<span style="color:#f92672">.</span>IN_AIR

    <span style="color:#66d9ef">if</span> is_on_floor():
        _state <span style="color:#f92672">=</span> States<span style="color:#f92672">.</span>ON_GROUND
</pre>
<p><em>That’s not the state pattern yet, only an intermediate solution that can help you in some cases.</em></p>
<p>This is a significant improvement over using boolean values only already. How? We won’t have to add booleans and have to switch multiple if we add more states.</p>
<p>You can also wrap state changes in a function to initialize and do a cleanup, for example, by changing the horizontal acceleration and maximum speed when you are in the air.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">var</span> ground_speed :<span style="color:#f92672">=</span> <span style="color:#ae81ff">500.0</span>
<span style="color:#66d9ef">var</span> air_speed :<span style="color:#f92672">=</span> <span style="color:#ae81ff">300.0</span>

<span style="color:#66d9ef">var</span> _speed :<span style="color:#f92672">=</span> <span style="color:#ae81ff">500.0</span>


<span style="color:#66d9ef">func</span> change_state(new_state: <span style="color:#a6e22e">int</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">var</span> previous_state :<span style="color:#f92672">=</span> _state
    _state <span style="color:#f92672">=</span> new_state

    <span style="color:#75715e"># Initialize the new state.</span>
    match _state:
        States<span style="color:#f92672">.</span>IN_AIR:
            _speed <span style="color:#f92672">=</span> air_speed
        States<span style="color:#f92672">.</span>ON_GROUND:
            _speed <span style="color:#f92672">=</span> ground_speed

    <span style="color:#75715e"># Clean up the previous state.</span>
    match previous_state:
        States<span style="color:#f92672">.</span>IN_AIR:
            <span style="color:#75715e">#...</span>
</pre>
<p>So, there are some benefits to using this solution.</p>
<p>However, you’re left with a lot of code in one place and the ability for any function to access variables it does not need and should not be aware of.</p>
<p>And to do so, you want to add extra functions and conditions to change your object’s properties when you enter and exit a given state. Having it all in one place is error-prone.</p>
<p>Now, imagine you want to reuse some of the states for monsters. Well, with this example, either you reuse all the code or nothing. You can’t just take the ability to climb walls or to make combos with a sword.</p>
<p>That’s where the state pattern and finite state machines come in.</p>
<h2 id="state-pattern">State pattern</h2>
<p>The point of the state pattern is to segregate every state into a stand-alone object. That is to say, one object for the ground or run state, one for the jump state, and so on.</p>
<p>We also implement a state machine that keeps track of the current state, takes care of cleanly transitioning from one state to another, and always delegates update and input callbacks to the active state only.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>This has several benefits:</p>
<ul>
<li>Each state only has access to the properties it needs instead of all the other states’ specific variables.</li>
<li>Optionally, we can write characters and states in such a way we can reuse behaviors.</li>
<li>Each behavior is encapsulated in one file, making it easy to debug and jump to it in your codebase.</li>
<li>The state machine becomes a generic and reusable component so we can share it in our codebase.</li>
</ul>
<h2 id="how-to-code-it">How to code it</h2>
<p>Let’s see how to implement the foundations. We are going to code a simple character with idle, run, and jump states.</p>
<p>We need to code two main components:</p>
<ol type="1">
<li>The <code>StateMachine</code> that will hold an active state and delegate work to it. It will also change the active state.</li>
<li>A virtual <code>State</code> base class that every concrete state will inherit. Doing this ensures that every state has some methods the finite state machine can call.</li>
</ol>
<p>We’ll start with the <code>State</code> class as the state machine uses it.</p>
<h3 id="the-state-class">The state class</h3>
<p>We are going to make every state extends the <code>Node</code> class. This will allow us to create state nodes directly in the editor.</p>
<p>With a state machine, we want to control the active state and delegate process, physics process, input, and other callbacks.</p>
<p>To do so, we are going to give our state class functions a different name. Each of those is a virtual function, meaning that we want to override them to create state classes like the ground movement we will code in a moment.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Virtual base class for all states.</span>
class_name State
<span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Node</span>

<span style="color:#75715e"># Reference to the state machine, to call its `transition_to()` method directly.</span>
<span style="color:#75715e"># That&#39;s one unorthodox detail of our state implementation, as it adds a dependency between the</span>
<span style="color:#75715e"># state and the state machine objects, but we found it to be most efficient for our needs.</span>
<span style="color:#75715e"># The state machine node will set it.</span>
<span style="color:#66d9ef">var</span> state_machine <span style="color:#f92672">=</span> null


<span style="color:#75715e"># Virtual function. Receives events from the `_unhandled_input()` callback.</span>
<span style="color:#66d9ef">func</span> handle_input(_event: <span style="color:#a6e22e">InputEvent</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">pass</span>


<span style="color:#75715e"># Virtual function. Corresponds to the `_process()` callback.</span>
<span style="color:#66d9ef">func</span> update(_delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">pass</span>


<span style="color:#75715e"># Virtual function. Corresponds to the `_physics_process()` callback.</span>
<span style="color:#66d9ef">func</span> physics_update(_delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">pass</span>


<span style="color:#75715e"># Virtual function. Called by the state machine upon changing the active state. The `msg` parameter</span>
<span style="color:#75715e"># is a dictionary with arbitrary data the state can use to initialize itself.</span>
<span style="color:#66d9ef">func</span> enter(_msg :<span style="color:#f92672">=</span> {}) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">pass</span>


<span style="color:#75715e"># Virtual function. Called by the state machine before changing the active state. Use this function</span>
<span style="color:#75715e"># to clean up the state.</span>
<span style="color:#66d9ef">func</span> exit() <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">pass</span>

</pre>
<h3 id="the-finite-state-machine">The finite state machine</h3>
<p>The finite state machine class uses the state. It keeps track of an active state, handles transitions between them, and delegates built-in callbacks. Like <code>_process()</code>, <code>_physics_process()</code>, and so on.</p>
<p>We chose to let the states call the <code>transition_to()</code> method on the finite state machine in our implementation.</p>
<p>That way, every state is responsible for defining possible transitions to other states. Also, to transition to another state, we pass in the name of the state node we want to transition to.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Generic state machine. Initializes states and delegates engine callbacks</span>
<span style="color:#75715e"># (_physics_process, _unhandled_input) to the active state.</span>
class_name StateMachine
<span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Node</span>

<span style="color:#75715e"># Emitted when transitioning to a new state.</span>
<span style="color:#66d9ef">signal</span> transitioned(state_name)

<span style="color:#75715e"># Path to the initial active state. We export it to be able to pick the initial state in the inspector.</span>
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">var</span> initial_state :<span style="color:#f92672">=</span> <span style="color:#a6e22e">NodePath</span>()

<span style="color:#75715e"># The current active state. At the start of the game, we get the `initial_state`.</span>
<span style="color:#66d9ef">onready</span> <span style="color:#66d9ef">var</span> state: State <span style="color:#f92672">=</span> get_node(initial_state)


<span style="color:#66d9ef">func</span> _ready() <span style="color:#f92672">-&gt;</span> void:
    yield(owner, <span style="color:#e6db74">&quot;ready&quot;</span>)
    <span style="color:#75715e"># The state machine assigns itself to the State objects&#39; state_machine property.</span>
    <span style="color:#66d9ef">for</span> child <span style="color:#f92672">in</span> get_children():
        child<span style="color:#f92672">.</span>state_machine <span style="color:#f92672">=</span> self
    state<span style="color:#f92672">.</span>enter()


<span style="color:#75715e"># The state machine subscribes to node callbacks and delegates them to the state objects.</span>
<span style="color:#66d9ef">func</span> _unhandled_input(event: <span style="color:#a6e22e">InputEvent</span>) <span style="color:#f92672">-&gt;</span> void:
    state<span style="color:#f92672">.</span>handle_input(event)


<span style="color:#66d9ef">func</span> _process(delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    state<span style="color:#f92672">.</span>update(delta)


<span style="color:#66d9ef">func</span> _physics_process(delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    state<span style="color:#f92672">.</span>physics_update(delta)


<span style="color:#75715e"># This function calls the current state&#39;s exit() function, then changes the active state,</span>
<span style="color:#75715e"># and calls its enter function.</span>
<span style="color:#75715e"># It optionally takes a `msg` dictionary to pass to the next state&#39;s enter() function.</span>
<span style="color:#66d9ef">func</span> transition_to(target_state_name: <span style="color:#a6e22e">String</span>, msg: <span style="color:#a6e22e">Dictionary</span> <span style="color:#f92672">=</span> {}) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e"># Safety check, you could use an assert() here to report an error if the state name is incorrect.</span>
    <span style="color:#75715e"># We don&#39;t use an assert here to help with code reuse. If you reuse a state in different state machines</span>
    <span style="color:#75715e"># but you don&#39;t want them all, they won&#39;t be able to transition to states that aren&#39;t in the scene tree.</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> has_node(target_state_name):
        <span style="color:#66d9ef">return</span>

    state<span style="color:#f92672">.</span>exit()
    state <span style="color:#f92672">=</span> get_node(target_state_name)
    state<span style="color:#f92672">.</span>enter(msg)
    emit_signal(<span style="color:#e6db74">&quot;transitioned&quot;</span>, state<span style="color:#f92672">.</span>name)

</pre>
<p>Another approach to state transitions would be to have every function of the <code>State</code> class return an arbitrary text string or enum member and let the <code>StateMachine</code> handle all the transitions. That second approach can help make states a bit more reusable between scenes as they do not know the other available states they can transition to.</p>
<p>Although the <code>StateMachine.transition_to()</code> method above uses a conditional check to make the system work even if states try to transition to an unavailable one.</p>
<h2 id="applying-the-state-pattern-to-our-player">Applying the state pattern to our player</h2>
<p>Let’s see how to code the foundations of our character now. We will create three new scripts that extend <code>State</code>, one for each of three states our character will have: idle, run, and air that will handle both jump and fall.</p>
<p>The <code>State</code> objects will take control of a host. In our case, it will always be the scene’s root node. To that end, we set up our scene structure with a <em>KinematicBody2D</em> as the root named <em>Player</em>, which has a <em>CollisionShape2D</em>, and a <em>Sprite</em>.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>We also add a node with our <code>StateMachine.gd</code> script attached to it, and three more nodes with three new <code>Idle</code>, <code>Run</code>, and <code>Air</code> scripts that all extend <code>State</code>.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>There are two ways you can go about controlling the <em>Player</em> from the state nodes:</p>
<ol type="1">
<li>Have all the character controller’s properties stored on the root <em>Player</em> node.</li>
<li>Have properties defined in the relevant state, like having <code>jump_impulse</code> on the jump state only.</li>
</ol>
<p>We’ll use the first approach because it allows configuring an instance of the player in another scene. It generally groups all the scene’s settings in one place, and it’ll also allow you to write shared code in the <code>Player.gd</code> script, to which all states will have access.</p>
<h3 id="writing-the-first-state">Writing the first state</h3>
<p>Now, we can start to control the <em>Player</em> node from our state scripts.</p>
<p>For each state, we only have to override the methods that it needs. In the case of idle, we only define transitions when pressing a key. If it is <kbd>Left</kbd> or <kbd>Right</kbd>, we go to the run state. If we press <kbd>Space</kbd>, we go to the jump state. Finally, if the floor disappears from under the character, we transition to the air state so it falls.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Idle.gd</span>
<span style="color:#66d9ef">extends</span> State

<span style="color:#75715e"># Upon entering the state, we set the Player node&#39;s velocity to zero.</span>
<span style="color:#66d9ef">func</span> enter(_msg :<span style="color:#f92672">=</span> {}) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e"># We must declare all the properties we access through `owner` in the `Player.gd` script.</span>
    owner<span style="color:#f92672">.</span>velocity <span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span><span style="color:#f92672">.</span>ZERO


<span style="color:#66d9ef">func</span> update(delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e"># If you have platforms that break when standing on them, you need that check for </span>
    <span style="color:#75715e"># the character to fall.</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> owner<span style="color:#f92672">.</span>is_on_floor():
        state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Air&quot;</span>)
        <span style="color:#66d9ef">return</span>

    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;jump&quot;</span>):
        <span style="color:#75715e"># As we&#39;ll only have one air state for both jump and fall, we use the `msg` dictionary </span>
        <span style="color:#75715e"># to tell the next state that we want to jump.</span>
        state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Air&quot;</span>, {do_jump <span style="color:#f92672">=</span> true})
    <span style="color:#66d9ef">elif</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_pressed(<span style="color:#e6db74">&quot;move_left&quot;</span>) <span style="color:#f92672">or</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_pressed(<span style="color:#e6db74">&quot;move_right&quot;</span>):
        state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Run&quot;</span>)
</pre>
<p>Notice the use of <code>Node.owner</code> in the <code>enter()</code> function. In a saved scene, the <code>owner</code> property points to the root node. In our player’s scene, every node’s <code>owner</code> points to the <em>Player</em> node.</p>
<p>It’s a convenient property the engine uses for scene serialization and that we can leverage. It has a limitation, though: its type is <code>Node</code>, so in the editor, we don’t get full auto-completion and linting errors for the node the states control.</p>
<h3 id="adding-auto-completion-and-type-checks">Adding auto-completion and type checks</h3>
<p>We can improve the situation by creating a short and specific <code>PlayerState</code> script. It contains some boilerplate code to get full completion and type checks for the <code>Player</code> node.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Boilerplate class to get full autocompletion and type checks for the `player` when coding the player&#39;s states.</span>
<span style="color:#75715e"># Without this, we have to run the game to see typos and other errors the compiler could otherwise catch while scripting.</span>
class_name PlayerState
<span style="color:#66d9ef">extends</span> State

<span style="color:#75715e"># Typed reference to the player node.</span>
<span style="color:#66d9ef">var</span> player: Player


<span style="color:#66d9ef">func</span> _ready() <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e"># The states are children of the `Player` node so their `_ready()` callback will execute first.</span>
    <span style="color:#75715e"># That&#39;s why we wait for the `owner` to be ready first.</span>
    yield(owner, <span style="color:#e6db74">&quot;ready&quot;</span>)
    <span style="color:#75715e"># The `as` keyword casts the `owner` variable to the `Player` type.</span>
    <span style="color:#75715e"># If the `owner` is not a `Player`, we&#39;ll get `null`.</span>
    player <span style="color:#f92672">=</span> owner as Player
    <span style="color:#75715e"># This check will tell us if we inadvertently assign a derived state script</span>
    <span style="color:#75715e"># in a scene other than `Player.tscn`, which would be unintended. This can</span>
    <span style="color:#75715e"># help prevent some bugs that are difficult to understand.</span>
    assert(player <span style="color:#f92672">!=</span> null)
</pre>
<p>We then update the <code>Idle</code> state to extend <code>PlayerState</code> and replace every occurrence of <code>owner</code> by our new <code>player</code> variable.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">extends</span> PlayerState


<span style="color:#66d9ef">func</span> enter(_msg :<span style="color:#f92672">=</span> {}) <span style="color:#f92672">-&gt;</span> void:
    player<span style="color:#f92672">.</span>velocity <span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span><span style="color:#f92672">.</span>ZERO


<span style="color:#66d9ef">func</span> physics_update(_delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> player<span style="color:#f92672">.</span>is_on_floor():
        state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Air&quot;</span>)
        <span style="color:#66d9ef">return</span>

    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;move_up&quot;</span>):
        state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Air&quot;</span>, {do_jump <span style="color:#f92672">=</span> true})
    <span style="color:#66d9ef">elif</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_pressed(<span style="color:#e6db74">&quot;move_left&quot;</span>) <span style="color:#f92672">or</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_pressed(<span style="color:#e6db74">&quot;move_right&quot;</span>):
        state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Run&quot;</span>)
</pre>
<h3 id="the-run-state">The Run state</h3>
<p>Here is now the run state, in which we use the owner property of the node to control the player.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Run.gd</span>
<span style="color:#66d9ef">extends</span> PlayerState


<span style="color:#66d9ef">func</span> physics_update(delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e"># Notice how we have some code duplication between states. That&#39;s inherent to the pattern,</span>
    <span style="color:#75715e"># although in production, your states will tend to be more complex and duplicate code</span>
    <span style="color:#75715e"># much more rare.</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> player<span style="color:#f92672">.</span>is_on_floor():
        state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Air&quot;</span>)
        <span style="color:#66d9ef">return</span>

    <span style="color:#75715e"># We move the run-specific input code to the state.</span>
    <span style="color:#75715e"># A good alternative would be to define a `get_input_direction()` function on the `Player.gd`</span>
    <span style="color:#75715e"># script to avoid duplicating these lines in every script.</span>
    <span style="color:#66d9ef">var</span> input_direction_x: <span style="color:#a6e22e">float</span> <span style="color:#f92672">=</span> (
        <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;move_right&quot;</span>)
        <span style="color:#f92672">-</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;move_left&quot;</span>)
    )
    player<span style="color:#f92672">.</span>velocity<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> player<span style="color:#f92672">.</span>speed <span style="color:#f92672">*</span> input_direction_x
    player<span style="color:#f92672">.</span>velocity<span style="color:#f92672">.</span>y <span style="color:#f92672">+=</span> player<span style="color:#f92672">.</span>gravity <span style="color:#f92672">*</span> delta
    player<span style="color:#f92672">.</span>velocity <span style="color:#f92672">=</span> player<span style="color:#f92672">.</span>move_and_slide(player<span style="color:#f92672">.</span>velocity, <span style="color:#a6e22e">Vector2</span><span style="color:#f92672">.</span>UP)

    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>is_action_just_pressed(<span style="color:#e6db74">&quot;move_up&quot;</span>):
        state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Air&quot;</span>, {do_jump <span style="color:#f92672">=</span> true})
    <span style="color:#66d9ef">elif</span> is_equal_approx(input_direction_x, <span style="color:#ae81ff">0.0</span>):
        state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Idle&quot;</span>)
</pre>
<h3 id="the-air-state">The Air state</h3>
<p>Finally, we have the air state. It controls the jump and fall, which you could alternatively split into two states. I like to merge them into one because I want the horizontal air movement to be consistent whether the character is going up or down.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Air.gd</span>
<span style="color:#66d9ef">extends</span> PlayerState


<span style="color:#75715e"># If we get a message asking us to jump, we jump.</span>
<span style="color:#66d9ef">func</span> enter(msg :<span style="color:#f92672">=</span> {}) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">if</span> msg<span style="color:#f92672">.</span>has(<span style="color:#e6db74">&quot;do_jump&quot;</span>):
        player<span style="color:#f92672">.</span>velocity<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>player<span style="color:#f92672">.</span>jump_impulse


<span style="color:#66d9ef">func</span> physics_update(delta: <span style="color:#a6e22e">float</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#75715e"># Horizontal movement.</span>
    <span style="color:#66d9ef">var</span> input_direction_x: <span style="color:#a6e22e">float</span> <span style="color:#f92672">=</span> (
        <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;move_right&quot;</span>)
        <span style="color:#f92672">-</span> <span style="color:#a6e22e">Input</span><span style="color:#f92672">.</span>get_action_strength(<span style="color:#e6db74">&quot;move_left&quot;</span>)
    )
    player<span style="color:#f92672">.</span>velocity<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> player<span style="color:#f92672">.</span>speed <span style="color:#f92672">*</span> input_direction_x
    <span style="color:#75715e"># Vertical movement.</span>
    player<span style="color:#f92672">.</span>velocity<span style="color:#f92672">.</span>y <span style="color:#f92672">+=</span> player<span style="color:#f92672">.</span>gravity <span style="color:#f92672">*</span> delta
    player<span style="color:#f92672">.</span>velocity <span style="color:#f92672">=</span> player<span style="color:#f92672">.</span>move_and_slide(player<span style="color:#f92672">.</span>velocity, <span style="color:#a6e22e">Vector2</span><span style="color:#f92672">.</span>UP)

    <span style="color:#75715e"># Landing.</span>
    <span style="color:#66d9ef">if</span> player<span style="color:#f92672">.</span>is_on_floor():
        <span style="color:#66d9ef">if</span> is_equal_approx(player<span style="color:#f92672">.</span>velocity<span style="color:#f92672">.</span>x, <span style="color:#ae81ff">0.0</span>):
            state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Idle&quot;</span>)
        <span style="color:#66d9ef">else</span>:
            state_machine<span style="color:#f92672">.</span>transition_to(<span style="color:#e6db74">&quot;Run&quot;</span>)
</pre>
<p>Compared to our initial example, grouping all the logic in one place, you can see how much code and setup using a state machine adds. With only three states like these and an un-refined movement, it’s probably not worth it. As with many patterns, it’s only as your projects grow in complexity that you start to benefit from them.</p>
<p>That’s why we saw a simpler solution first. I invite you only to use a state machine when you need it, which you’ll learn to judge through practice.</p>
<p>That does it for the pattern’s basics. In a future guide, you’ll learn how to handle signal connections, and more.</p>
</body>
</html>
