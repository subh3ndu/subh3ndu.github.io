<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Tmp2erj8A8TmR</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <style type="text/css">:root {--c-caption: grey;--c-blue: #26bfe3;--c-green: #02e180;--c-orange: #f2971a;--c-pink: #e3266f;--c-bg: #fff;--c-bg-alt: #f5f5f5;--c-text-header: #fff;--c-text-body: #95989a;--padding: 20px;--padding-inv: calc(-1 * var(--padding));--fonts: "Open Sans", -apple-system, system-ui, "Segoe UI", "Roboto","Helvetica Neue", Arial, sans-serif;--font-size: 1.1rem;}html {font-size: 100%;}body {color: #444;font-family: var(--fonts);font-size: var(--font-size);line-height: 1.7;padding: 1em;margin: auto;max-width: 800px;background: #fefefe;}a {color: #0645ad;text-decoration: none;}a:visited {color: #0b0080;}a:hover {color: #06e;}a:active {color: #faa700;}a:focus {outline: thin dotted;}a::selection {background: rgba(255, 255, 0, 0.3);color: #0645ad;}*::selection {background: rgba(255, 255, 0, 0.3);color: #000;}p {margin: 1em 0;}.caption {text-align: center;color: var(--c-caption);font-style: italic;}.note,.tips,.warning {display: block;width: calc(100% - var(--padding) * 2);padding: 0 var(--padding);padding-bottom: var(--padding);background-color: var(--c-bg-alt);}.note:before,.tips:before,.warning:before {display: block;margin: 0 var(--padding-inv) 10px var(--padding-inv);padding-left: var(--padding);font-style: bold;color: white;}.note:before {content: "Note";background-color: var(--c-blue);}.tips:before {content: "Tips";background-color: var(--c-pink);}.warning:before {content: "Warning";background-color: var(--c-orange);}img {max-width: 100%;}h1,h2,h3,h4,h5,h6 {color: #111;line-height: 125%;margin-top: 2em;font-weight: normal;}h4,h5,h6 {font-weight: bold;}h1 {font-size: 2.5em;}h2 {font-size: 2em;}h3 {font-size: 1.5em;}h4 {font-size: 1.2em;}blockquote {color: #666666;margin: 0;padding-left: 3em;border-left: 0.5em #eee solid;}hr {display: block;height: 2px;border: 0;border-top: 1px solid #aaa;border-bottom: 1px solid #eee;margin: 1em 0;padding: 0;}pre,code,kbd,samp {color: #0084b8;font-family: monospace, monospace;}pre {background-color: #f9f9f9;padding: 1em;font-size: 14px;white-space: pre-wrap;word-wrap: break-word;}code {white-space: pre-wrap;}b,strong {font-weight: bold;}dfn {font-style: italic;color: var(--c-blue);}ins {background: #ff9;color: #000;text-decoration: none;}ul,ol {margin: 1em 0;padding: 0 0 0 2em;}li p:last-child {margin-bottom: 0;}ul ul,ol ol {margin: 0.3em 0;}dl {margin-bottom: 1em;}dt {font-weight: bold;margin-bottom: 0.8em;}dd {margin: 0 0 0.8em 2em;}dd:last-child {margin-bottom: 0;}img {border: 0;-ms-interpolation-mode: bicubic;vertical-align: middle;}figure {display: block;text-align: center;margin: 1em 0;}figure img {border: none;margin: 0 auto;}figcaption {font-size: 0.8em;font-style: italic;margin: 0 0 0.8em;}.author {font-size: 1.2em;text-align: center;}tag {min-width: 3.2em;text-align: center;border-radius: 8px;padding: 0 4px;margin-bottom: 0;margin-top: 4px;margin-right: 0.2em;display: inline-block;color: white;}tag.update {background: var(--c-blue);}tag.new {background: var(--c-green);}tag.update:after {content: "update";}tag.new:after {content: "new";}button {background-color: var(--c-blue);color: white;border: none;cursor: pointer;line-height: 2rem;font-size: 1.2rem;margin: 0.75rem 0;overflow: visible;padding: 0.75rem 1.5rem;border-radius: 1rem;transition: background-color $transition-duration;white-space: nowrap;}</style>
</head>
<body>
<h1 id="the-dungeons-rooms">The Dungeon’s Rooms</h1>
<p>Let’s design the dungeon’s rooms. We will use the <code>RigidBody2D</code> type for that, as we want to use the physics engine to spread our rooms around the map.</p>
<p>Create a new scene and click on <em>Other Node</em> in the <em>Scene</em> docker. Add a <em>RigidBody2D</em> node as the root node and name it <em>Room</em>. Next, add a <em>CollisionShape2D</em> node as a child of it. It’s required by <em>RigidBody2D</em> to detect collisions. You should have the following:</p>
<figure>
<img src="data:image/png;base64,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" alt />
</figure>
<p>With <em>CollisionShape2D</em> selected, add a <em>RectangleShape2D</em> resource to the <em>Shape</em> property in the <em>Inspector</em>. Make sure to toggle on <em>Resource &gt; Local To Scene</em> as well.</p>
<p>If we don’t turn on <em>Local To Scene</em>, we’ll get the same collision shape for all rooms. We don’t want that because we want our rooms to have random sizes.</p>
<figure>
<img src="data:image/png;base64,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" alt />
</figure>
<p class="note">
By default, all resources are shared between scenes and objects. When we change a property on a resource, the change propagates to all shared instances. <em>Local to Scene</em> makes the resource unique for each scene, which means they’re no longer shared, and changes to one resource won’t propagate to other scenes.
</p>
<h2 id="gotchas-of-using-physics">Gotchas of using physics</h2>
<p>When using physics for procedural generation, you must be aware of potential unexpected behaviors and rough edges of the engine. It can be frustrating for beginners and intermediate developers alike. We’re going to point out potential problems as we encounter them.</p>
<p>Rigid bodies have multiple modes. In the default <em>Rigid</em> mode, Godot applies angular forces, allowing the body to rotate. In <em>Character</em> mode, this doesn’t happen, which means the body will always remain upright. For our algorithm, we want to use <code>RigidBody2D</code> in <em>Character</em> mode.</p>
<p>In the <em>Rigid</em> mode, rigid bodies go to sleep if collisions aren’t detected after a moment, but not in <em>Character</em> mode. This is a <a href="https://github.com/godotengine/godot/issues/7996">known issue</a> that causes confusion, and we have to deal with it in our code.</p>
<p>We want the node to go to sleep after a while, as it indicates the room reached its final position in the generation process. We have to manually check for the absence of collisions and find a way to keep it in place.</p>
<p>Before moving on, select the <em>Room</em> node and set the <em>Mode</em> to <em>Character</em> in the <em>Inspector</em>.</p>
<figure>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAEYCAMAAAD1fnTgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA2FBMVEUmLDtARVMZHSfg4OAlseD///9RVmIzOk8gJDH//+uAhJB2eYNnbHliZnFFTFxucXl6fohUWWasr7XNztKZnKOyt7taX2w6P07Hyc4zOEWjtfCQk5qHi5QtMkCjpavBw8h/zM+9Zq67vcL///Gn3/HZ8vRLv+N/0eZLUV/4ZnglKDVfa5AqhqyjVHtpnOllyObb29yk4Tzs9PWVpdy85/Q2t+Jhd6JNWXiISm2Qs4ksTGbG6+hYhcCAjbzx+uuE/7FuQV4poMstaIbqrq7VjqnLr6+nZa98sDHqR9dDAAAgAElEQVR42uydaW+ruhaGoZEICkOYMWWS+IToSVXtSm20lUrR/f8/6noEkwCZml3arlfnhMTEA8tej5cN3VF0EAj0a6WACUAgAAAIBAIAgEAgAAAIBAIAgEAgAAAIBAIAgEAgAAAIBAIAgEAgAAAIBAIAgEAgAAAIBAIAgEAgAADolo7Z7S7vmzwM8yvqUtPKXxCF9e0NXyyg8wAAN8sz/22+2zN/tv8/P19MgLxaLCpMgBX25eKCfGnhVwtGgK8FwIw64B8pqWN9XQVXn/90AMRBiTzr8nJS3y+P8xXHJUXOcG6/SuPrhgLJ7CMpH6l1sJqDfCl5rf1Zjj/s/5gAvaS/OO0J99cbOfW2HPIf7sMEANwNLQ+VaT5kYUkhzsUAsBgfBL2+nDDvAQA03x6/SloM6wda/mw6wC3c6fPrtSteB2OqNZc6CutEd4O1bmFSq0PcPXVeb/bbzWa71/XthlWCP2LhnHuazs7nlwIgDGzVcq8AQJqoaz86SDWPrz91hnPHboDq6wAQxFhSPlJr+r0B8LAjEcCuHxO8L5e7JwyAt3yJYfD3OFcRvizCgkUCzA3z1E3UIhiy8AQAqqFB0OvL9GwABFU20QUSAEj5s+kAEkLFE+eJb4vXsfNMIwXYC0+PF37TeGmjq5ef1xXi79tNDwBbLL0hfr/Z6jk5ECBcBIDE55fdrCrk5fhQ0gnEs4KyMmg6Sxj0pjTQvTpDBs1d8A4VOViJZCYKRnwxDbtve0aAKjIcKgKVAttRSVG1Ts0xRyaDHVUGqRH/z6ppm0EbdZQvEwBoKyWZrYJV/NV6fh5I/N+OAIC8e9sNZXpZsJVA9SK5oRnKFh6OHEIvDMORQcDMJxtnuBfJwM8JAPJu2OfIRWSMWSGqnPbADc6KYf3Ayhe9PgMALF7S/BYAmPS/MQDkfqjortroV57X8TSfYEM2MgDoMSdO3+CmJ43ebDbCwff7hsUN+0kANBVH+yrUYux6ThEnAe5qr7R1lcwfImEUAOFKTXBuO3HKnHaqyMFLDJzRyVj1ValCN4mQLQEgC9U4RRMASMUXSK20mrYZtFHjEUBbKclcqnqN7JkC4KkFwPJ5OQIA4v951s27amjIFh6OALrp/3gQMPP1jBMMRwBrXPNigRvQjvu1p4c4to+RnauaOLQGD6QIgJXPe30OAFgs/HVzrwjgVmHXFl15AABlsxGxSxPjSEAAYEsIgNcF0wDQ7cqzcFqDaATYkM5QfUX3MuaGbcLAdKpEyNK9gGbTSI/SWUPk4CWOAIAO18Z3+xWSoSEAoJAylUEA+HQi6b4gANA1IxjdO8CSrpJkXklMmRsAchL4MwA0Q2sAAgDq/9LsjpAjW/gMABwMAm6+nnFGAEDqXizkBoRr3fCwdREdnPzQGjzomsbKz2ZifG6Q0a3UkwAwRQxwqgaql4vP43m+0dmav7cHsKWxwZZOd/jjvpG2DPZNwzAwBQBdj4qy1mOfdmHsl1g4IvTWzHfbhGNvQj4J3ugXWe4sJZ0qcvASpyIA3Xf7FRpFBwCWPzRH9gAS6QsCAF0z1uN7B5YvXaW4AKOYJQAUsgWg//fGzg8D4MD/dbz09wLJwvrY5uFCXrzLg4Cbr2ecEQCw3QepATYugq4oHBSQ/Qd2aA1+FAHMxfg3A+BkBED92i0nAPDSNWQEANttHwDbLZ3fE5y8p5M+RkHr7wp2/mP/H7wN6FQdANQEq2G7MxQAPGHAm/J2H03tAYDlmAZAxgLUuKuwBwBPAMAbXwJ0XxAAkJsxtQnYu8rZAaB7HoD5/4klAPP/Qn4eQPWTzsLnRAD9QcDNdxoAjtPdiXQcKcoicUPi0EiEHlqDH0UAcwLAy21LAOsMAOiN8zINgIO38hIgoa9HSwDazwQPB2kkBjj2/0EAaIhHz/gQSfvjuLvahLGFOP1ifwnAcvASpyKA1JMqFMEgWUE2JV4C+DV5Mw6A7gvHS4BpAPSu0iOpwYyWADvxPAD3/xObgIsqoXO6FAZQAAgLH3t/6A0BoBsEMgCEcQZ7kRaQh17e3gvAKzIcZBklHXY1EofW4EcRwJyWADduAq4ZBKYBgIlYXAUAMt8rgwDIGRgapentFJANw/2x/x8CQF3bsUa6OQvrOMrxPOAmqtkBoE0YnsPFYOltAvIcvMSVl+QDvogj1aJUu297ZZRYZKmYFk1j+GsyeONkhcaWADH5gppkYg+AViM3Q5+4CyBfJa3Yn8UmYKsd8//dEksRtwGXIwAQonv6tqkmtlfIFh66BdAHwOEgkAAgjDPYizJB2HuzaigGojhKcgPHFOzQGpwWw/vPk3t9BgC4723AmwGQb8RtPnb7TxW3AVWavtX3G7JC2DQnrvQAAHFRomqFE5WspLcBnYret2kBIBImIwDSw6iw+W1AnoOXmBQoHdqPQ1VGpq62QpffjUuCslqla3qXrzS8sU1AhL8QoMpIuR/TahqpGRMRQO8qZ3Mn6gAAzV/2/i99EGj3lujnAEDF/RmuctnCA/H/AQAOB4EEAGGcwV48BoDHbr6uirhA5IYsP7QGp8WwZQIr353JPdhTDwJp9BEg7YYHgW5cArDnffiDQER78SAQew6ooTsB2/3FDwJ9rj79wY5rHlL84ibfqt3zFX8U4PV3Aqd0yXPA08bpbVzDXwToD1MnwxObgOEpAIzWJs/5jf7FAPhkf1X4qvQXAeDhmj8K6m8CTuuSvwSaNo4j+78DAJhUHU7fBjx1/tNc6o7XmMSo/rzS1m6SpFXz2wAwK4FxfpzuCYAAfeZ+LvmzlkKFMQ4AAH0TAIBAIAAACAQCAIBAIAAACAQCAIBAIAAACAQCAIBAIAAACAQCAIBAIAAACAQCAIBAIAAACAS6IwAebtC3vPKHuwtG14/X9x82HQCWV+tBV27Ul/Td8s4CAPwCANxj2PxTHwIAAABAAAAAAAAABAAAAAAAQAAAAAAAAAQA+HEASCwr+UIA3O2XIkEAAOVKN/hVALAMwxrpu/jt4/Xx9S0GAID6av+JY2fgHzv/lgDouQEAgOr99RHr4+P1/XozGDY72gYA4GcBgP/qVTYbAETqXQFQk5+TMa5qcmyZVn6Wz8f2jJYA78T9H58ICAQBAt+/yAjL9R+fEkD1/xgAgB8FAPYjK/SXj0cBYJZ+ZZ89WMzVWQDQrIQcrPhTAXByCVAFkWuY1zErNs+c9DV7PpuA8SsJAN5YKMBXAUFQuwZan28F2/+D8AiwEQcBAOCHACBjP7hMfnc9m4gAIv+C2SI4FwDuHQBwahPQ9jXuFxmOBOxlnJZloC6XoVGgijacJww1OTFp+1zLUuPIihLxgZyrLZYQ15atmabpzgUATx9vOP5n7z/eBAD4C7GC53bH0PBQtTZD5NUDBOj8HwDwM+QQ1ye/BEow4IwPIosAoPURo0JVxj8bks8wn8LhpV90I8pK0WoYADb1ffrCvSfXLMumAMAJWn6XuwBlxo5ZZWk4EMg8zS4K3M4yWroo6hJGI4AIRy6qGeWK5rIPsbXEDY6S3MYLhCiqk1xxZ7QE+Hh/enzksf87B0GQkl7DV5mFUZ2VansMS3fp+J69DIqBGKDzfxkA657Aqb6Zctpl63xyFqERgPCRGpF5b0kHiyX7DPepgjh8O6LC1LVHAKCSFTUBgPAeLUoSzcQAsHGC695lCRBVoUFghSwaB5D2uz5uJ3EJz+kSxiOAGpPKjMmWAPugaJqikAQlspWItvorADC2Cfiq4iXAK3uvvnYRQIRMboVwJY7UDKqPO9EqB1YBnf8DAH6BjiIA7iMacmki/YyHkvAZ7lMUAN2IKkaXALbi1gwAwnvokUTUZHsgMe90F8D0MMk0NpZrv8TCy4LQYS1vE8YjABKhmAkHAPlgR7ixJF6pNb6AmRUAHmWJTUDkky0AZoU0EEdqhth3CR4OAaD6fxaDAIAlwM8HAIsAuI8sMxRE4vPKa32G+xT9Sm9EjQIgx46OASC8hx2xC/2fvXPhbRVX4nhYE1hhcAjPsCEgob276LbqRttzG6nq0Wr7/T/U9YNHQvwgKWnTxHN6mjZQXvb8/J8ZiDPXw+ZmlyoD5lULACtcImwknmFH3r0hyQHsAwBdDQAEIUD687fn5w4CnQKoE4ZtRH9rX+ll4AMAC4CQZQI1AO4vBGhyAI132yhf5XR8pwBofWYfAAc9SgiAmZEIAJBtsF3sRiBvhXt5EwI0BYH25Lo3RioAi7i71aQySAjwZQAQtd0LSQDsGgDsJQHzOOWEACIA0Pwf6gmgAXBXScDkEACkf6R2TFLJRdT5TONTdpHvhwBSAGB/SdLee/oQIL1UFWDpJ5ZHjnwdJ7VrYDHgoiXcO7n2jZEKwDM2BvmlSwKykkCyh68vBkBKM4AvDABGnwRMSSI3jxNMc6N75QPg/bHJ//cE0AC4CQNOXwZ0wEgFYLnIcCr8+2qBYJj0PtP41DrAcmC/R0kAgAfswyTgpqZJQC/dZMYlAFAH5arKSRZwXa4C/JqXTUmjpVvzhvBGoEEI0JYBUVMGpL9sEs+6nhuBnjsCdDcCRbRRl/Rsg8TuXrkAeDQfYZP/Q/pGoNsCwCk3ArU+UgcrVuFz2jJg4zONT6FgFR30KAkAZoiO+mivDGjRvBr2NfQNngXg3bRwdbcC188/H5DxQu8GPN1e/zXNR30r8M0C4PxbgU+6l/RGnwX4FgCwjYefz7/9fDHOOf930yQA0I8D3yoAzn8YSAPgqgBwkceBXx9NDYB7tW8JgPsNAU5quxPkvwaABsA3AoAqCag/EegEY8O/BoAGgP5EoDsEQDv8awBoAGgA3B8A3k1TA0ADQAPgTgHwaGoAaABoANwpAPbkvwaABoAGwIcA8Mvn2URt926aKgBou1m7RgCcdwazC57KVdo0bff6aCoBoE13ous/Aw2ACeS/BoAGgAbAHbXd0fCvAaABoAFwe22Hxg7/HwQAupJrg77F1tEXracBoLYvzsl+CgDeTVMDQANAA4ALgNlX2uQAqEfK/48CoL6SXlF/i63XX7SeBsDdAQCNlP9aAWgFoAFwDwrg3TRNrQC0AtAAuEsF8PpoXgYA31UBANB/52wNQqQVgAbAzSgAsfzvAGDkMdhWjvRzhQLywTIgEO8HdLaVbMb3VUcfBPz388nGQjkAYO5A+daTIAzpxy1ybD6n26DGfpYeZR2Ha0MrgEkBIGrYHp1FGBboqwBQR1UV1RIAWFEVUj+qEnnbvezGjA2y4b8BgBs2juspAQDEY9AkAMDeL2o/kH+OAoB5DqVbd9hZOhIA+JD8OwQA9ygLvKFIfTa7h4fdxRRA02oSwsrdycWNSlvVX8rWS5Jx710cAIh29xBJAQCtE/167B/AkNgKigEQBWHFmqSSt93709PLq2JskA//DADeFsQuQi5WAdK5lY1yAICaf90/AgC8EfzFFQFASID6FAcHBzYiBBhuPdluHYSc7VbSeSHsv0tHbNIXt5GhWA/7/zEBDtajM3ngrp0Ui7MBILi+STUYiwbm+h0AZARIfJf3t7KLSIQWnB4ABQiSZQyKYwC4ObHZomb+jJLpAVCvVossW6xWtRAAeKiNj7snr+2esL3tZCPiu2kqAWCEYM3WXoNQFgX4oJQrgMkAwG1CICQAmhQAqq0HbOx3QCA5S9h/l47YAdhiAgSS9cjg/0BNdlx+TL9XNlyeDwD+9a2wLvQqaYt2ABATwPAhGvsuO71GcgZoagBg+R8HSxByAOBmaZbNrJT5s3sBAEThgrwswkgIgHg0AF6eqD0YorHh0RwBAAfE/a4d2ZXzkVwBjAkB1OpcAgABAc7LAZybvQ8Bm0fhoAcNBy9/nAJwt/SCheL1GucnlkmOC5EZH7oJoNic3mQaH49MB5sXIwHAvb6gCwADNQCEeF/wx/rEXwhDzhDL0kV4uNcpABChEsQJFwBe58v4P9ED2Fs9xyHzmkHDy9mkxrBe5E5C5whxcpiSCYVzZ0kB0Kxb+2wFjsUhnRYxCyspAII4jtXwfn1qbCAD0Ej5zwBQAZfoPKLyXBCLBBxdbqtzAEGxvSAA+ARAkwJAVQVo/1q2lZEKoPH/w6t+uF7v/zvpWQc5mQ+3pgBo5vT2seusqzWd9ncMAERXS3E1RwFA6OgCMNiQqFF8UFifwqlzACUosb4oVACYLYgTJ9DOFpgD0PdSNqUpdIxZmht4kW9kibOZuX6aubnVrZvlxiYVfKZwpQZAwG0Qbtu9Nf4/0AC1VP7/NQAAHdEqmnEQj2ps+SA4HyiA1u/9StBR2u6xEHcUFQC4EoWrANA6jtdIDADhclUVQA4Akv33uy/5UVL/3wZhUY9RAPhnyVnDis7mSQDQzum9DFO78kvsQ8sxABBRADS5SmqFLKgTAwD5PhItgYLYaMEu8eJAAsgBoM7vFGFE/b/gJgFpDsA9BECOh/g038zgovVXn2ACYjVAIDDzlxvyuiEAaNZN8/SDIcBYAOyo/7/yRkRR8f+P//w4AoAhBQB1+uowJclVAAwAEUxtGQASC/+hB4UAEHdEsM35BOD1IBSTia1jJAKAeLmiCqDoYjT9332Jt1MXYUD935WfTQ8ANMgCHK5nYK+vfAqAdk5vu/SWZbpaeqX9QQAY3fKQ3669iRKFyUnJQdtekWGJ7BGB1WQAQCEoUIX9P+KXAd1FmuJhfh8Adu5gwx4Nl120T37Cy+ycDOaem9JX3+rXTXLXUCQBw0QBgHH5GyYAODkAkfz/cz7/wQkBEJP4HsfLmWM3IYBs5GUdJMXabS0Lyi0fJtxUY7LF7khTCEIA2HwC8MbodRlZVlSu+YiRLFdVAdQAOBr7edtpMM+puwz2V/dBwINsvWJN5+3GAGjn9LYLx4nsyMmjcQAQhwBJd8bx5wAgYmrjVACoQoACBNT/jxaIQwA8mmfY9pN89Ce8LB0CoFt3liV5Ii0DhmGQyUMA+59/RgDgAY//b0cEQKLs3/9+zI8BkIO4ArU4CQi2BhyTH2c9BKakshW4sgSZ77scRHgYHy5zfyEA+ATgRelBiZWGVQYiAAiXq/RF8/eio2R3APhQtR1a/+PWXYdnIwLAYD23dIg+pyFAs1W/KFwbFn0pTQGAQZfrAeB3AIgEACBlZF8WAoiy/fw6QIoVZ8mU5CkhgAoAIUhiMv6fAIBZjoZZ/hYAm/0QYEZDgH7SUyMXBQEoqsooCfYIsA+AGBvrWaMA8Pr0ZhtvT4P80E4w/P/x95wDACPEPREyF+SVAcG2BP6I/Hh73df0FgaRxncx8gUEyLsqghgAXALwBEdZ9t95PUS2XLp1BQAgR/zztsO5sVJwNq3313IFgM9lwQDQzeltlaVho1VZjwHAcZfrARB1APAFADBonD9dErDebq0mtJkwCRiCZVChIhwJAA/i4TxxUJZaPADMEj/FQz1LAno0CcjWtVG2WTrycmC2R4BfD/tFzGBMTAkA+w13CmPg/6Ls35/zOQ8ANBfFkju5xw/LSzRKATRth/9gLSklGrib8AVhDloBACTpgWMC8I6uOhsAiirACAVAvlRXy4i2/JB6uL901xUBdtKzXq+MBgDtnN42FThxZY8CwFGX6wEQd1feEwAAkbF8yjKgS68gcsPDqOOjIUC8TAJOJpMPgAzmLvFqWtPjAGC2XwZ0rVm7bkbSSOlsNAF+HdQATwHA7rjzy+Q/FwCkYVeyotm4sarLE8dgDYQdwfdIQCi4YSRvUwCVHAADAtTCUh+/LzAHFi1XVAEUOYD5nMUA7GfZUa75SXXe2aT035jah9zOBUDYnbFxXgggCgLE1YHu0Ka8EYhzE/ABAD7VsqBKjwGwZvcBjw0Bjk2U/fvr77kMAIV4i2Kxyn0WYGu4le0Ukgp57dpLwVMHTRTAvfMUCAmATgSAfPnHqgAYAEQAwGMAoKOS1Dau1QpgbG7iwwAQhQCV58pygJjnJKsDWQ5QnPvhJvs8X/4wwNS3Ah8/BvR1AJhlKScEWDZPAp0LAJH8/30+FwLgbBONQaqpZS17Wpv28wBUzwJc+ig//WlARRIwqTr/r3jCrRn6GyEg3vmnPQx0ht3K48Di4v/8EgDQnwh0ie3ozwPQADiz7d7/lWb/uAAwH8+33ZX0Cv2JQBoAGgDq7B8fAB+wd60AtALQALgSALxKi/8XAYBWAFoBaABcCQAUxX+tALQC0AAQA+DbTwwyUv5PC4BXW9v3dB8NgNtqO3Xx/6YVgDYNgLtuuxHFf60AtGkA3GbbjSr+awWgTQPgRtrOObCX0dm/yQHw4mj7Tna7APjltm0IALhnb+Ozf9OHAOK8JvyE3Knex2n7uGUAzG7ZJADwxxb/NQD0PjQAbg4AJ8v/zwTAf33HuninRutmRxfaG95H6rSbv9w+0P/ZuxNmRXEtAMDwuMKVfSdcQaqoXqjrVHU/6daq6fFWzfv/P+olYXXhCigKelI9o8Yl4zT5yEmORBTdodsAAB4OgH87D/9vCQDPv4pDAxBqet7QQK2RNt5fg6HbwIfz4G08EwDy9Ep3ADZdFv/vAIDsv2rhkANh+g4xb6hVaz3bwI0M3gYzfBvPBMDBY370pTsA/3Ra/K+V9Zf+pQsA+DjW/FsAQBtq1VrPNnhj8DYUOxm6jXcA4IEAaJz9+zobsvx4xhGAp99ilBG8D9yG0gyAt9mlb+nGG1FPdzlyrRCR/gEAjgDoNft3YwCSbtFsfwBoQ61a69UGIzKDt0G+yPvAbTTnAWzTN1x2u3Q7HgAccvmxgDvcFR4AoAD802v278YAvEud5rP7A0AbatVarza0RRCEA7eh0FWAYdtonAPYku7/RrYeKwWwLQs50t0BiAgAEQBwCECPxf87ADD4aji84yoAeCkZAGyyoUAeBdh2YkhIu3cIEHGK0huAcEXimlU4NQBk07JM7RMA/td39m8oAKQTBybcG9+9BgBWuw0e/2f3d5sCgPxfXhAh06huHclEsSY7yEwGFoBc2jc42hC6PQBJFtds0u2kAGDzS7DGbAMATNMv/7/OAAC41wOA3Xb19paP/bc5BDbZ2WWxxF3QcZMgYstbJzIE3TJVwV7eAABBPNwCojUAahbXMIxKBKB9LJrN1pw9bgA8xCHF8xTEWexJAISei/8AANxrACBl8bkyze6zaTUCcJEseIhs4OCIxa3gYBlYSxYEJboFAELjJtlnAAhpXLOie/GlYQ4AkiV7thg1ABGH6HZBPuKiUwDcc/gPADwoAG/1UkwCIotMAfB0F52FXdwKjo7DAcsgPIwagNUGD2t29H64WeUARFQBnjec9eynVN1y9s/1ehFw65/anQGQOU5heMfhGYXj5CMAwr/usvjfCMCfeWP57xzK2MppALzdW5qWCJQjgMRFriDQHcfxo+KWbj14CwCKzYo6AWAoIe7vioE70k7d4rgm6z/JrgZAjAFwOF0210p5y60lfjn7qRiRdWcAYo7zGLI9IONxXHwIQOPwfzYDAKD0BEDYkAmAbQ5AbRIwcLwTIcCYAXB1LQw13cUApD6Ja7L+I6QlAIa4XvDGTMSPuGVxy3MOz7uzgOeD9f0B8JsBuHsAAAA8IgAenQHcZACw1SSgRzYYDhxXDRBb3o4aANz5NfwnJADsxTXlJOAM939emylkKBAVt8QArAKOBcTZuEOAe08BAgCPCECe/0MFKBOByDKgQjo6Wf4jSbn57a0AIFtE/+w8B4AFoP0fhwB7cU05CSjOdJ6X8o4vlQDYOQD6vQFgUDUJiE5NAr43zQL8AgCg9ARASNLdSmU3NBtwJMXMN6TuOAkYKkqYTQKSCYAirqlNApqckY328Wm/uK0AuPsIgGGtM8uAr3/fNQwAAB4RAIElSXO7DTuenwIkJmeSeUfT7LsMmOCbVQaAXwHgrs0Tk4DjGQEwapQlAkVqUyYgc79EYADgQQF4wJ8Db2kGYBbXMLVVABF3dMPMlwHNYhlwNCMAXLRzqcDC3X4KBAAAAJO5HgCb7raCv8kWAx/sx0B//3ufHwMDAADAdC4IQn8MtFv5D/hrwMYfBAyeEQQAAADTuSLQ+6P+HPh+KQEAAAAAlwQbAwB3SgkAAAAAAGAUADSmBAw6FwgAAAAAwDgA6J0SsP7av/wGAAAAAGAkAPRMCbjevgAAAAAAG4PcYWOQ6lJvfVICAAAA4GEB8J5ia7DaxR57pAQAAAAAPaReJ1YAgBMA9EgJAAAAgAyAaXUDAOAkAK+vXzrOBQIAAAAA8EAAzL9+65QSAAAAAADAIwEw//jeZS4QAAAAAICHAmA+//K7/VwgAAAAPBUAq/rVwVaj/55ndwY6BUBDGPD7VEoAAAAAjB+AxI5jO7kKAG/71wc8XUiX2+92n5cur+1Szu4M1ADAfN46DAAAAIAGACR+LP1fskhB0nUAOHHfFx0U2ewRAEulrKrdrXVQO0Km3AYAY4niIGSYBf4i8YJt973P7gzUDMD8T8swAAAAAOoAyAEpjJZkAKjuFfov/RAt6X/+R0jzfQ2hZCAAfMd0VV4PjwDQqktx1e5WBQ9LVNltAUBoymziBBgA22PdJWpn67mdgQ4BkHAp/4I/frRKCQAAJlT+fAwPgOx7vs/wXgaAfA0A6Ifw/WfkbIv2L82yBwIgiPO+H4oRWqoVAOQf2UGxmN0tn5aXUazjzy9OzKZkI1LBqMsosn36ChST/+owiKKFnw9kTAzAgn4jp9X/tzOXBf90BEDmAtukBAAAEyrfv30dHAClHP7jf8h4AB/GiijKuItIrBIY2dOJFojkLJZXuWIgebXqvXdkH0IDirw60QOxgyyOlZ0HrXggAKLiBC46CStGfh0AFvF+YmQPy6ejhFHJWZx2egJApHiuhStY1/NMnVSojEFeIZqsZ+dwiXYBgGqpLb735zsDnQdg/qdFSsABAN/6FwBgeACw3jcFgNFIP3Ulwdfw8S/pipedzCTRY9iALapcnfVdMayq999BP4R8Wl7tB2zosTbtOtwAABC+SURBVO0BiAcGwLfyEXmIDHo6rwOgIrWICqqnAzIpIGHJYpOAxpiLvIIUHfdz+grc2UMStqgWHWB4EV8AEFpuOwD8iwBokxKwD8CPYQ5cAOBqALz8+BgWADIFIO8DEOCO5AW4f5eRrqTQaAEf7LSK9HlGN6rq/XeUAOTVXuDdJgRgvKNyCgCvAIC1hKzf1kMAEdl8BkD1NOnqNj37u0vSrcuKxHacaJlPCuAhP2tFuNBIwTdFpgCAaQXApSFAq5QAAGBiALz8/jMoABruJf4eAEIg4oI7rWTsLRAY+KinVUJAztCKXFYfvKMAoKx2A5ntMQlY7zWvHX4OfDYEQLls6ikAGE9E2RzA3tM5ABiImCkrPKSFjL7MRdAJACplh/R/MigoQ4BW3//czkAtAJivv31+lQAAYGoAYL1vGwLgE7aPS31dkHZsV8qrvBKAvPrgHQUAZTXju0GX2cVsGdCyTH8YAGwnbAwBSOFRuB8C1AEwUAWAS/rpYpnHBDYJAfLVw7z/F5OAZrs0AKv/MuDRUdMQBgAA0wPgKmFAhzmAQD1MDJDIgFST86qwDAGK6v13VCFANfXFBp0WEu04sl2zJsBVAWAjR1ETmc7yefrBJKDi+VJcTgKWT5P+rkoJa5h2BYBqub5MQ4BI8WQrIeMD10s03P9tFZcwXwaM1Jbf++zOQC0A+DwlAACYIABY7xsBoEj4jO2Kqu/xewAEic/TSUBa5eoePqeHVfX+O+iH0EnArFpQ/dAQuy8H+jUBrgoAwy4ii/RbRo+RmewtA7ImKlcG60+T/s4uIxSLYVXBSBFauDQEyJcBsQBkFdHNhjAGSQRCcYc5EK1XKvBB+SwlAACYIgBY74+bAOBLgUxX+ciyXT0EKJYBs6piGbCo3n8H/RB6N6vGj+nLLxHgAgBapAJfXIbKDe4HwGcpAQDANAF4uTQl4KLfAjRkCQ+ePOybsXchALf5MdB9ANjLBNwvjVcJ+AIATBOAS1MCJgkA43uXhgC3KWMbATSnBLwAAFMF4LK5wGkCcPkqwLMCMJ//+g0APBYAF6UEAAATLb0BmH98AwAeC4BLUgKe4YIgAEC7lAAAYLIA9A8DAIAnBKAxJQAAmCoAvVMCAIBnBKAxJQAAmCoAfVMCnmFjEACgQ0oAADBVAPqlBDzR3oAAQKuUAABgqgD0SgkAAJ4VgM9SAgCAaQLQYy4QAHgkAKSytPrLb0wJAAAmCkD3lAAA4GlHAJ+kBAAAUwWgc0rAIQD/mVgBAC4BoOlYAgCmC0DHMOAIgCl3AwCgMwCnUwIAgAkD8PLyCwAAAFqXUykBAMCkAeiSEgAAPDsAp1ICAIBpA9AhJeAUAOyIS3H8+4bhAwDXAeA4JQAAmDgA7VMCpgqAoSgGAHAlAI5SAgCAyQPQdi4QAAAAjlMCAIAJAfDl+yUpAQAAAHCcEgAATAmAWVNC1/chAFA3u/Qt3agAwGgBaJ0J2HhYAQCTAmDWuO3Lx9UB2KbkKpq7XSq37LGO3v0ZAOD2I4C9lAAAYFoAzGbf+6YEdARgS6+iuyEQKHmVbVmI9mVTqr2wfECewi+xoiXfDIBsoshW8xfaLgBwFwCqlAAAYGoANIcBH9cEQE3TrP+zrJvmUYC9NFwd4f6u1ztu+YACsOQN2TEbAVAd3VDiRfbC/7d3r81tIlkYgKEcsxIXAaK5pZtmhlFsVpmpzMaVbCVZu2rGSeb//6PtBoHkCwiwrvg9VSNAOJov6kenTx+pbR5ZAOAoANQtAQDg7AC4/PhhUEtAPwA+334W+X95fvt5BQApFCgH9IxEqU6c1QWPUjZ3Vn9iROKBptE8WN/xWXVDVXV/9YcqzwDAkQBYtQQAgPMD4PJyMaQloB8At/99//bt+/I8uH0GAOIHLomcRxfyT3IuHmhmuSzN6zty0Ku8GPUq5RUAgRcAgCMBULYEAIBzBOCycduXu10BcDMTU4Cb8jy/WQNgRXYx5meRKT7eVwDMvOqCeFHk8Vl5W/X1+k4uhnr5pJrLxL8EQPVsAHAsAIqWAACw93h3NTzeNADQWAtsaQnoCcCDHfWqImDkyRKAHPOBl68m9/VFVtQAXNeaz1W3eIaQ9R3OVDstywBUBQAnAcD07goA7B+AN7uKTQD6twT0BeDmpkbgpi4CWkXZ7nkA/KoGkHtW8AAAecfIypvl+K+nAC4AOCIA0+k3AHCmADROA64+7qQI+Fak6+YKgI0iIPXVddavphtTALWqAaiaZ62mAGx9ZxYFqcAjL8d/VQT0UQQ8LgBTAHCuAPRtCejZB/DWKhgoIl8DMMtYXffT6EYRsLwgRNMsns1kEVBjUb6+I/KHVI5/HoiYlcuA8ygAAEfoBAQAh4xvewOgX0tATwDMm/eVAO/VjVUA0wuKMZ9XK3/VRbEmWDYCybyepdHc2rgj/qH47Le9IsyiqSgjLhqBkAEgAxgMQK+WgL6twO7N7ft8drse/y/s8Z15FlqBAQAA2CUAfVoC9vBloNW6XrcwMnwXAAAAgB0D0L0lYMdfB9Zt1yVp568K5kHmAAAAgBrArgHo3BKwYwAMP0rnQec/n0cU3wYEAMgA9gBAx5YA/CAIAAAAowSg+VcC3gEAAAAARg9A8zRg0Q6AttPY7XbgAAAAoAbQFYAOLQEAAAAAgLFmAB1aAgAAOgEBwPEBeDc8LttjS0sAAEAGAACODsDV5f6ivSUAAAAAAHD0GsA+AWhvCQAAAAAAjDoDaG8JAAAAAACMHYCWloCeAFCjy5hnvuf5rAGAuQkAAAAAOCgAzdOA/z0HAOPlOGfcfjS0SQcAguyiiCx4AEDi+FFGQgAAABCHrQGUtcCGacDvk2cAILQYyZzYAzKA7MLTLUv3LrJNABJ/Hqi5owAAAIA4fAbQ3BLw17+eAqBzSwxdgxUA6IRTcekyThwJgKsTwtzG8a9feMVHf+BdsA0AWLYannODRJkhTlSSplQ8Oc9ZZNRXSz2L5sn6nWyz4t8pugEAAAAAeEk0tQT8/QQAhzky3zclADqxAoe7Ii2wgmJu4FAroKwRAP9CryTwNwBI7aoGkFqxG+WTSejG8VwM67mvq3F9pftaGGy8k3UuWVAo1wEAAAAAe2kJ+F15DIAtf8WPaAIAl5sy9XdcWQ9wBQCuzA4s3pgCeBdWeWJdeGsAEi+vAKDiga84MIh4gtQtbGSyjNyH7+SECgEUxmkCAM60E/CXKv5Tn/2CGsAxAGisBf719REA4tNf0x0JgMVlQs9YeSSGeIIQwrn1/PDnsvw3fwpAvAZAjn3iyCmA76dk9UR1FXrJ5KkA9fgHAGeYAdSj/h8AcNwMoKUl4O/lQwB05ooRXwOgbwJgyZ/wbcgA3PTiInKfTgGWkbm5DCgAiCN7WWYA8onq6ikAUoB6/AOAMwbA/8f3AcCRAbhsKAW++foQAIsbVCunALIQSJxiKlBOAey2NQDrzz9N7ZkiIPGXDwFwI3GkFQDV1TJ62jmUMJZgFaALAEmcnDAA6Zd7AHBkABqrAMmjKYBG5TiXRUCnKAIGRRFQL4qAxA6s5uVApxj2weNlwFD+VNjMXNYAqJ6WWGkFQH3F/DwMEiwDDgBA023b1rXTzQAAwLFrAItPLesADwEwZJlPAuA6G8uAzCifIM6WZoCnjUAhTb2UrAGYGGlE3QqA+kqRWwcAgCEAlLMAHRkAMoCGToC2EuCOvwvQ3AqM7wLsCwBHi5NYM1ADAAADFgHxZaCzB2CpmbaZL08VAP/Hl/sfPgA4FgCLxuofvg2IVYD9AuCLyH7cf7kXAsgAAAcHoLER+Cu+DgwA9g7A/f29+O9HebgHAAcHoPEXAfB7AGMBwHgQ/z6p+OP79+/iv3l5+P7Hz5+/vvb4eVAAmrYMv/0VACADOMwUwP9RJAGYAhw+A2j7VUAAAAAOVgTkKAI2APBmMTzeDV38L34XGAAAgIMtA9pYBmwCYF/7AjT3/l6Vu4Q+B8A5BAA4PwAyH41ADZ2A+wNg2z7hAAAAHCwDAAAHzwAW23YHBAAAAACMFYCtG4MBAACAGsBoAWjZDuCAAKAICABW8QU/CHLIGkDbhkAAAAAAgFFnANuqf9PffgMA4wTgZHcH/jJFHAqA1sX/cvwXAgAAZAAAYHwAtC/+AwAAAABGXANo2gWoTv8BAAAAAKPNALYu/gMAAAAAxgpAh8V/AAAAAMBIAeiy+L8NAIMHxZvM4do+AFBoBAAAwOuOu+vh0QZAp8X/rQBQJg8xJ/sAIJwTAAAAEIPjuhGArYv/HQGweSgOlkMFAKpOiJOIIUc5MevDCwAwTRUAAADE7gHYuvjfFQDTkWOczmQGEGpxSE0l5LNEnVWHl9UAZgAAACB2DcDH7Yv/nQHIifjoJ0o1BTAdMfJVebY6AAB0AgKA0wKgy+J/ZwAUkhePcgrgUEp0gQB35Cf/6gAAkAEAgFMCoNPif3cAbCchoQQglisCli5rgja31wcAAAAAwMkA0HHxvzsAIQ+YIgHIuVwP1Is33YxvHgAAAAAApwFA18X/7gAojLsFACHPE1dMAUItTixSHQAAAAAAJwNA58X/HgAEJCkAUCzCjVwAwAhhanUAAAAAAJwIAD0W/zsCgFZgAAAAzgWAqzfdF/8BAAAAACMDoM/iPwAAAADgNQBwfTcFAAAAALxOAD4ttr/IgQFQn0QqQu0YAACdgIjOADQv/p8UAFmaAQBkAIhdA3Dd6UUwBQAAAGCEAHz6NgUAAAAAvFIAPtxNTwyA/QQAAAAAoPfiPwAAAABgvAB0qv4BAAAAAEYJwPXdFAAAAADwOgH4tOj1IigCAgAAMCIA+qT/AAAAAIBxAXDd90UAADoBAcBYAOi6+A8AkAEAgPEB8OFuCgAAAAB4pQAshrwIAAAAAGAMAPSt/gEAAAAAxgPA9d30CADQAAAAAABwdAA+LYa+SAsAjiEeNC73/7D1+h2nu88BoJm9AYhJmjrL9TmJAQAAQAwBYGD6vwWAgIoHg9gPP+kD9TkAjP4AzGmo+np1HseUAwAAgBgAwPULXqQFgJDHikJsKjcID0UWQIiRlGM+MTixDHFCLUecifHPOXf6AaB64qkwKlOAKJ9MtBQAAABEbwAGLP53rAEQV1FJIga/S8T4Z2GsOyUABlVDQ+4VRokb53KSoPfOAIpNAZZe+Ss/VPwPiA4AAACiLwAf7qb7AsAw5H7AuiVPErkdsMoTCUDCc5EFFADIMgGzhgCQROZE0b28uFiSNNVRBNwVAEYdAGDsACxe+CJtALhUYa4SMIW6Yj5ARIhsQABQzA2KVIBaSjn4+wMw0bIoNVcZQJDZLA0AADIARC8AXlD96wCAmPqLoR6uHtVYhLIGgAWrIqAzDAA5UItCwGQSR6GcE8QAAAAgegBwfTfdJwAKlRVAkedTmfFrdeE/KZYGSQWAPhSAyYSR4pAX9b80BwAAANEdgMUOXqQVAIPIcW1zuRJokjxWV2PeYGFs880MwGYyO+jXB5CETiRmAHNnkqRGkhipAgAAAOKw0QpALit/iiprflIALnsCimVAufjHNjOAmHGjJwCOlxJZARAATGY8TbmKGgAAQJwSALtqA0YrMAAAACMDoCwEAAAAAABeHQCBFoYOSQAAAAAArxEAl3KihwoAAAAA4NXWAJQhALTs/Nlhm2AA0AcAdAIizgqA7dsEAwBkAIizBgBTAAAAAAAAAAAAiNcFwH4CAAAABAAAAAAAAQBW8X+euaJ2RrEcwAAAAABJRU5ErkJggg==" alt />
</figure>
<h2 id="the-room-class">The Room class</h2>
<p>In the <em>Room</em> script, we’re going to:</p>
<ol type="1">
<li>Place the object in a circle following a random distribution.</li>
<li>Detect and emit a signal when there are no collisions.</li>
<li>Implement <code>iter_*()</code> functions to turn the object into a custom iterator, as we did in the first chapter. This will make our life easier in the main script when saving room data for tile manipulation.</li>
</ol>
<p>Add a script to the <em>Room</em> root node and replace the default code with:</p>
<pre style="color:#f8f8f2;background-color:#272822">class_name <span style="color:#a6e22e">Room</span>
<span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">RigidBody2D</span>


<span style="color:#75715e"># Used to test that the body didn&#39;t move over consecutive frames.</span>
<span style="color:#66d9ef">const</span> CONSECUTIVE_MAX_EQUALITIES :<span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>

<span style="color:#75715e"># Radius of the circle in which we randomly place the room.</span>
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">var</span> radius :<span style="color:#f92672">=</span> <span style="color:#ae81ff">600</span>
<span style="color:#75715e"># Interval to generate a random width and height for the room, in tiles.</span>
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">var</span> room_size :<span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">9</span>)

<span style="color:#66d9ef">var</span> size :<span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span><span style="color:#f92672">.</span>ZERO

<span style="color:#66d9ef">var</span> _level: <span style="color:#a6e22e">TileMap</span> <span style="color:#f92672">=</span> null
<span style="color:#66d9ef">var</span> _rng: RandomNumberGenerator <span style="color:#f92672">=</span> null
<span style="color:#66d9ef">var</span> _previous_xform :<span style="color:#f92672">=</span> Transform2D()
<span style="color:#66d9ef">var</span> _consecutive_equalities :<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

<span style="color:#66d9ef">var</span> _area: <span style="color:#a6e22e">float</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
<span style="color:#66d9ef">var</span> _iter_index: <span style="color:#a6e22e">int</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

<span style="color:#66d9ef">onready</span> <span style="color:#66d9ef">var</span> collision_shape: <span style="color:#a6e22e">CollisionShape2D</span> <span style="color:#f92672">=</span> <span style="color:#f92672">$</span><span style="color:#a6e22e">CollisionShape2D</span>
</pre>
<p>We register this class globally as <code>Room</code>, using <code>class_name</code>. Then, we define the constant <code>CONSECUTIVE_MAX_EQUALITIES</code> to test for a stable body position. It will become clear when we get to the meat of the functions.</p>
<p>We have a couple of exported variables for easy access from the <em>Inspector</em>. The <code>radius</code> is the radius of the circle in which we generate a random point, in pixels. The <code>room_size</code> is in <em>TileMap</em> coordinates and defines the interval in which we generate a random number for the room size, for both <code>X</code> and <code>Y</code> axis.</p>
<p><code>size</code> stores the current room size at run-time. Next, we have a few pseudo-private variables. We store <code>_level</code>, passed in from the main dungeon generator script. We need it to convert to and from the <em>TileMap</em> coordinate system. <code>_rng</code> is again provided by the main script, and that’s why these variables are initialized with <code>null</code>.</p>
<p>We use the next two variables, <code>_previous_xform</code> and <code>_consecutive_equalities</code>, to test when the room gets in a stable position. Like <code>CONSECUTIVE_MAX_EQUALITIES</code>, we’ll get to details once we look at the functions.</p>
<p>We use the last two pseudo-private variables <code>_area</code> and <code>_iter_index</code> to implement the custom iterator functions, <code>_iter_*()</code>, as we did in the first chapter of this tutorial series.</p>
<p>We also store a reference to the <code>CollisionShape2D</code> to easily access it later.</p>
<p>We then move to the functions, beginning with:</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">func</span> setup(rng: RandomNumberGenerator, level: <span style="color:#a6e22e">TileMap</span>) <span style="color:#f92672">-&gt;</span> void:
    _rng <span style="color:#f92672">=</span> rng
    _level <span style="color:#f92672">=</span> level
</pre>
<p>We use <code>setup()</code> to pass in and store the relevant variables from the main generator script. We use the same <code>RandomNumberGenerator</code> instead of defining a separate one here.</p>
<p>If we wanted to save the dungeon, we’d keep one number, the seed of the <code>RandomNumberGenerator</code> instead of multiple seeds. We’d use independent random number generators. Doing so makes it easier to store the level and debug the generator.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">func</span> _ready() <span style="color:#f92672">-&gt;</span> void:
    position <span style="color:#f92672">=</span> Utils<span style="color:#f92672">.</span>get_rng_point_in_circle(_rng, radius)

    <span style="color:#66d9ef">var</span> w: <span style="color:#a6e22e">int</span> <span style="color:#f92672">=</span> _rng<span style="color:#f92672">.</span>randi_range(room_size<span style="color:#f92672">.</span>x, room_size<span style="color:#f92672">.</span>y)
    <span style="color:#66d9ef">var</span> h: <span style="color:#a6e22e">int</span> <span style="color:#f92672">=</span> _rng<span style="color:#f92672">.</span>randi_range(room_size<span style="color:#f92672">.</span>x, room_size<span style="color:#f92672">.</span>y)
    _area <span style="color:#f92672">=</span> w <span style="color:#f92672">*</span> h

    size <span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span>(w, h)
    collision_shape<span style="color:#f92672">.</span>shape<span style="color:#f92672">.</span>extents <span style="color:#f92672">=</span> _level<span style="color:#f92672">.</span>map_to_world(size) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</pre>
<p>In <code>_ready()</code> we first randomly assign a position to the room, within a circle, using our utility function <code>get_rng_point_in_circle()</code>.</p>
<p>Next, we generate the room’s width and height using <code>RandomNumberGenerator.randi_range()</code>, in <em>TileMap</em> coordinates. We compute and store the room area for later use. We also store the size of the room as we use it in multiple places. We could just use <code>collision_shape.shape.extents</code> instead, but <code>size</code> is more concise.</p>
<p class="note">
<code>RectangleShape2D.extents</code> is half the size of width and height.
</p>
<p>The meat of our class is this next virtual function:</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">func</span> _integrate_forces(state: <span style="color:#a6e22e">Physics2DDirectBodyState</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">if</span> mode <span style="color:#f92672">==</span> <span style="color:#a6e22e">RigidBody2D</span><span style="color:#f92672">.</span>MODE_STATIC:
        <span style="color:#66d9ef">return</span>

    <span style="color:#66d9ef">if</span> Utils<span style="color:#f92672">.</span>is_approx_equal(_previous_xform<span style="color:#f92672">.</span>origin, state<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>origin):
        _consecutive_equalities <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>

    <span style="color:#66d9ef">if</span> _consecutive_equalities <span style="color:#f92672">&gt;</span> CONSECUTIVE_MAX_EQUALITIES:
        set_deferred(<span style="color:#e6db74">&quot;mode&quot;</span>, <span style="color:#a6e22e">RigidBody2D</span><span style="color:#f92672">.</span>MODE_STATIC)
        call_deferred(<span style="color:#e6db74">&quot;emit_signal&quot;</span>, <span style="color:#e6db74">&quot;sleeping_state_changed&quot;</span>)
    _previous_xform <span style="color:#f92672">=</span> state<span style="color:#f92672">.</span>transform
</pre>
<p>Godot runs the physics simulation on a thread separate from the main one. <code>RigidBody2D._integrate_forces()</code> lets us safely manipulate the physics state.</p>
<p class="note">
It’s not safe to access and manipulate the physics state of a <code>RigidBody2D</code> in <code>Node._physics_process()</code> or any other function with the exception of <code>RigidBody2D._integrate_forces()</code>.
</p>
<p>Our implementation of <code>_integrate_forces()</code> works as follows:</p>
<ol type="1">
<li>We check if <code>mode</code> is set to <code>RigidBody2D.MODE_STATIC</code>. If so, then we don’t do anything, just exit the function.</li>
<li>We check for approximate equality between the previous position of the room and the current physics state position. This is done by accessing the origin property on the <code>Transform2D</code> of the current physics state. If the check succeeds, we increase <code>_consecutive_equalities</code> by <code>1</code>.</li>
<li>We check if <code>_consecutive_equalities</code> is greater than <code>CONSECUTIVE_MAX_EQUALITIES</code>. If that’s the case, then we have enough checks to deem this room as stable enough and change its mode to <code>RigidBody2D.MODE_STATIC</code> - remember step 1. We also emit the built-in <code>RigidBody2D</code> <code>sleeping_state_changed</code> signal at this point.</li>
<li>We save the current physics state <code>Transform2D</code> into <code>_previous_xform</code> which is how it becomes the previous state in the next function call.</li>
</ol>
<p class="note">
Implementing <code>_integrate_forces()</code> wouldn’t be necessary if Godot treated <code>RigidBody2D</code> the same in both rigid and character modes. A future update may address this issue.
</p>
<h3 id="implementing-a-custom-iterator">Implementing a custom iterator</h3>
<p>The next few functions that implement the custom iterator behavior are a mirror of what we went over in the first chapter of the tutorial series.</p>
<p>In Godot, an iterator is a class that implements the following virtual methods:</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Initializes the iterator. You can use it to initialize the iterator&#39;s index.</span>
<span style="color:#75715e"># Called at the start of a `for` loop.</span>
<span style="color:#75715e"># Return `true` if you want to continue iterating.</span>
<span style="color:#66d9ef">func</span> _iter_init(_arg: <span style="color:#a6e22e">Array</span>) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">bool</span>:
    <span style="color:#75715e"># ...</span>


<span style="color:#75715e"># Called once for every iteration of a `for` loop.</span>
<span style="color:#75715e"># Use it to advance the iterator&#39;s state.</span>
<span style="color:#75715e"># Return `true` if you want to continue iterating.</span>
<span style="color:#66d9ef">func</span> _iter_next(_arg: <span style="color:#a6e22e">Array</span>) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">bool</span>:
    <span style="color:#75715e"># ...</span>


<span style="color:#75715e"># Returns the value the iterator produces.</span>
<span style="color:#66d9ef">func</span> _iter_get(_arg) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">Vector2</span>:
    <span style="color:#75715e"># ...</span>
</pre>
<p>They allow us to iterate over rooms like so:</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#66d9ef">var</span> room <span style="color:#f92672">=</span> <span style="color:#a6e22e">Room</span><span style="color:#f92672">.</span>new(rect)
<span style="color:#66d9ef">for</span> point <span style="color:#f92672">in</span> room:
    <span style="color:#75715e"># ...</span>
</pre>
<p>We’re going to code our iterator to return all the tiles a room overlaps. Doing so allows us to draw each room in our final tilemap.</p>
<pre style="color:#f8f8f2;background-color:#272822"><span style="color:#75715e"># Initializes the iterator&#39;s index.</span>
<span style="color:#66d9ef">func</span> _iter_init(_arg) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">bool</span>:
    _iter_index <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">return</span> _iter_is_running()


<span style="color:#75715e"># Increases the iterator&#39;s index by one.</span>
<span style="color:#66d9ef">func</span> _iter_next(_arg) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">bool</span>:
    _iter_index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> _iter_is_running()


<span style="color:#75715e"># Returns the coordinates of a tile in the `_level` tilemap that our room overlaps.</span>
<span style="color:#75715e"># Running over the entire loop yields all the tiles we should fill</span>
<span style="color:#75715e"># to draw the complete room.</span>
<span style="color:#66d9ef">func</span> _iter_get(_arg) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">Vector2</span>:
    <span style="color:#66d9ef">var</span> width :<span style="color:#f92672">=</span> size<span style="color:#f92672">.</span>x
    <span style="color:#66d9ef">var</span> offset :<span style="color:#f92672">=</span> Utils<span style="color:#f92672">.</span>index_to_xy(width, _iter_index)
    <span style="color:#66d9ef">return</span> _level<span style="color:#f92672">.</span>world_to_map(position) <span style="color:#f92672">-</span> size <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> offset


<span style="color:#66d9ef">func</span> _iter_is_running() <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">bool</span>:
    <span style="color:#66d9ef">return</span> _iter_index <span style="color:#f92672">&lt;</span> _area
</pre>
<p>And this concludes our implementation of the <code>Room</code> class. Next time we’ll cover the main script and scene of the generator.</p>
<h2 id="references">References</h2>
<p>Below, you will find the complete <code>Room.gd</code> class for reference.</p>
<pre style="color:#f8f8f2;background-color:#272822">class_name <span style="color:#a6e22e">Room</span>
<span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">RigidBody2D</span>


<span style="color:#75715e"># Used to test that the body didn&#39;t move over consecutive frames.</span>
<span style="color:#66d9ef">const</span> CONSECUTIVE_MAX_EQUALITIES :<span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>

<span style="color:#75715e"># Radius of the circle in which we randomly place the room.</span>
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">var</span> radius :<span style="color:#f92672">=</span> <span style="color:#ae81ff">600</span>
<span style="color:#75715e"># Interval to generate a random width and height for the room, in tiles.</span>
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">var</span> room_size :<span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">9</span>)

<span style="color:#66d9ef">var</span> size :<span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span><span style="color:#f92672">.</span>ZERO

<span style="color:#66d9ef">var</span> _level: <span style="color:#a6e22e">TileMap</span> <span style="color:#f92672">=</span> null
<span style="color:#66d9ef">var</span> _rng: RandomNumberGenerator <span style="color:#f92672">=</span> null
<span style="color:#66d9ef">var</span> _previous_xform :<span style="color:#f92672">=</span> Transform2D()
<span style="color:#66d9ef">var</span> _consecutive_equalities :<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

<span style="color:#66d9ef">var</span> _area: <span style="color:#a6e22e">float</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
<span style="color:#66d9ef">var</span> _iter_index: <span style="color:#a6e22e">int</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

<span style="color:#66d9ef">onready</span> <span style="color:#66d9ef">var</span> collision_shape: <span style="color:#a6e22e">CollisionShape2D</span> <span style="color:#f92672">=</span> <span style="color:#f92672">$</span><span style="color:#a6e22e">CollisionShape2D</span>


<span style="color:#66d9ef">func</span> setup(rng: RandomNumberGenerator, level: <span style="color:#a6e22e">TileMap</span>) <span style="color:#f92672">-&gt;</span> void:
    _rng <span style="color:#f92672">=</span> rng
    _level <span style="color:#f92672">=</span> level


<span style="color:#66d9ef">func</span> _ready() <span style="color:#f92672">-&gt;</span> void:
    position <span style="color:#f92672">=</span> Utils<span style="color:#f92672">.</span>get_rng_point_in_circle(_rng, radius)

    <span style="color:#66d9ef">var</span> w: <span style="color:#a6e22e">int</span> <span style="color:#f92672">=</span> _rng<span style="color:#f92672">.</span>randi_range(room_size<span style="color:#f92672">.</span>x, room_size<span style="color:#f92672">.</span>y)
    <span style="color:#66d9ef">var</span> h: <span style="color:#a6e22e">int</span> <span style="color:#f92672">=</span> _rng<span style="color:#f92672">.</span>randi_range(room_size<span style="color:#f92672">.</span>x, room_size<span style="color:#f92672">.</span>y)
    _area <span style="color:#f92672">=</span> w <span style="color:#f92672">*</span> h

    size <span style="color:#f92672">=</span> <span style="color:#a6e22e">Vector2</span>(w, h)
    collision_shape<span style="color:#f92672">.</span>shape<span style="color:#f92672">.</span>extents <span style="color:#f92672">=</span> _level<span style="color:#f92672">.</span>map_to_world(size) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>


<span style="color:#66d9ef">func</span> _integrate_forces(state: <span style="color:#a6e22e">Physics2DDirectBodyState</span>) <span style="color:#f92672">-&gt;</span> void:
    <span style="color:#66d9ef">if</span> mode <span style="color:#f92672">==</span> <span style="color:#a6e22e">RigidBody2D</span><span style="color:#f92672">.</span>MODE_STATIC:
        <span style="color:#66d9ef">return</span>

    <span style="color:#66d9ef">if</span> Utils<span style="color:#f92672">.</span>is_approx_equal(_previous_xform<span style="color:#f92672">.</span>origin, state<span style="color:#f92672">.</span>transform<span style="color:#f92672">.</span>origin):
        _consecutive_equalities <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>

    <span style="color:#66d9ef">if</span> _consecutive_equalities <span style="color:#f92672">&gt;</span> CONSECUTIVE_MAX_EQUALITIES:
        set_deferred(<span style="color:#e6db74">&quot;mode&quot;</span>, <span style="color:#a6e22e">RigidBody2D</span><span style="color:#f92672">.</span>MODE_STATIC)
        call_deferred(<span style="color:#e6db74">&quot;emit_signal&quot;</span>, <span style="color:#e6db74">&quot;sleeping_state_changed&quot;</span>)
    _previous_xform <span style="color:#f92672">=</span> state<span style="color:#f92672">.</span>transform

<span style="color:#75715e"># Initializes the iterator&#39;s index.</span>
<span style="color:#66d9ef">func</span> _iter_init(_arg) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">bool</span>:
    _iter_index <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">return</span> _iter_is_running()


<span style="color:#75715e"># Increases the iterator&#39;s index by one.</span>
<span style="color:#66d9ef">func</span> _iter_next(_arg) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">bool</span>:
    _iter_index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> _iter_is_running()

<span style="color:#75715e"># Returns the coordinates of a tile in the `_level` tilemap that our room overlaps.</span>
<span style="color:#75715e"># Running over the entire loop yields all the tiles we should fill</span>
<span style="color:#75715e"># to draw the complete room.</span>
<span style="color:#66d9ef">func</span> _iter_get(_arg) <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">Vector2</span>:
    <span style="color:#66d9ef">var</span> width :<span style="color:#f92672">=</span> size<span style="color:#f92672">.</span>x
    <span style="color:#66d9ef">var</span> offset :<span style="color:#f92672">=</span> Utils<span style="color:#f92672">.</span>index_to_xy(width, _iter_index)
    <span style="color:#66d9ef">return</span> _level<span style="color:#f92672">.</span>world_to_map(position) <span style="color:#f92672">-</span> size <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> offset


<span style="color:#66d9ef">func</span> _iter_is_running() <span style="color:#f92672">-&gt;</span> <span style="color:#a6e22e">bool</span>:
    <span style="color:#66d9ef">return</span> _iter_index <span style="color:#f92672">&lt;</span> _area
</pre>
</body>
</html>
